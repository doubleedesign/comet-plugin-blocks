{"version":3,"file":"ColorControls.dist.js","sources":["ColorControls.jsx"],"sourcesContent":["/* global wp */\r\nimport {\r\n\tPanelBody,\r\n\tDropdown,\r\n\tButton,\r\n\tColorIndicator,\r\n\tColorPalette,\r\n\t__experimentalToggleGroupControl,\r\n\t__experimentalToggleGroupControlOption\r\n} from '@wordpress/components';\r\nimport { useRef, useState } from '@wordpress/element';\r\n\r\nconst ColorPaletteDropdown = ({ label, palette, onChange }) => {\r\n\tconst [hex, setHex] = useState('');\r\n\tconst triggerRef = useRef();\r\n\r\n\tconst getNameByColorValue = (colorValue) => {\r\n\t\tconst color = palette.find((c) => c.color === colorValue);\r\n\r\n\t\treturn color ? color.name : colorValue;\r\n\t};\r\n\r\n\r\n\treturn (\r\n\t\t<Dropdown\r\n\t\t\trenderToggle={({ onToggle, isOpen }) => (\r\n\t\t\t\t<Button onClick={onToggle}\r\n\t\t\t\t\taria-expanded={isOpen}\r\n\t\t\t\t\tref={triggerRef}\r\n\t\t\t\t\t__next40pxDefaultSize\r\n\t\t\t\t>\r\n\t\t\t\t\t<ColorIndicator colorValue={hex}/>\r\n\t\t\t\t\t{label}\r\n\t\t\t\t</Button>\r\n\t\t\t)}\r\n\t\t\trenderContent={() => (\r\n\t\t\t\t<ColorPalette\r\n\t\t\t\t\tlabel={label}\r\n\t\t\t\t\tvalue={hex}\r\n\t\t\t\t\tcolors={palette}\r\n\t\t\t\t\tonChange={(color) => {\r\n\t\t\t\t\t\tsetHex(color ?? '');\r\n\t\t\t\t\t\tonChange(getNameByColorValue(color));\r\n\t\t\t\t\t\ttriggerRef.current?.focus();\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t/>\r\n\t);\r\n};\r\n\r\nexport const ColorControls = ({ attributes, setAttributes }) => {\r\n\t// Use refs to keep track of the presence of attribute support without the fields disappearing when the colour field is cleared\r\n\tconst hasColorTheme = useRef(!!attributes?.colorTheme);\r\n\tconst hasBackgroundColor = useRef(!!attributes?.backgroundColor);\r\n\tif (!hasColorTheme.current && !hasBackgroundColor.current) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst palette = wp.data.select('core/block-editor').getSettings().colors;\r\n\tif (!palette || palette.length === 0) {\r\n\t\tconsole.warn('No colour palette found in block editor settings. Please ensure it is configured in theme.json to access colour attribute controls.');\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tconst getValueByColorName = (colorName) => {\r\n\t\tconst color = palette.find((c) => c.name === colorName);\r\n\r\n\t\treturn color ? color.color : colorName;\r\n\t};\r\n\r\n\t// TODO: Limit valid combinations of background + theme where appropriate\r\n\treturn (\r\n\t\t<PanelBody title=\"Colours\" initialOpen={true} className=\"comet-color-controls\">\r\n\t\t\t{hasColorTheme.current && (\r\n\t\t\t\t<div className=\"comet-color-controls__item\">\r\n\t\t\t\t\t<ColorPaletteDropdown\r\n\t\t\t\t\t\tlabel=\"Theme\"\r\n\t\t\t\t\t\tvalue={getValueByColorName(attributes?.colorTheme) ?? ''}\r\n\t\t\t\t\t\tpalette={palette}\r\n\t\t\t\t\t\tonChange={(name) => {\r\n\t\t\t\t\t\t\tsetAttributes({ colorTheme: name ?? '' });\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t{hasBackgroundColor.current && (\r\n\t\t\t\t<div className=\"comet-color-controls__item\">\r\n\t\t\t\t\t<ColorPaletteDropdown\r\n\t\t\t\t\t\tlabel=\"Background\"\r\n\t\t\t\t\t\tvalue={getValueByColorName(attributes?.backgroundColor) ?? ''}\r\n\t\t\t\t\t\tpalette={palette}\r\n\t\t\t\t\t\tonChange={(name) => {\r\n\t\t\t\t\t\t\tsetAttributes({ backgroundColor: name ?? '' });\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</PanelBody>\r\n\t);\r\n};\r\n"],"names":["PanelBody","Dropdown","Button","ColorIndicator","ColorPalette","__experimentalToggleGroupControl","__experimentalToggleGroupControlOption","wp","components","useRef","useState","element","ColorPaletteDropdown","label","palette","onChange","hex","setHex","triggerRef","getNameByColorValue","colorValue","color","find","c","name","React","createElement","renderToggle","onToggle","isOpen","onClick","ref","__next40pxDefaultSize","renderContent","value","colors","current","focus","ColorControls","attributes","setAttributes","hasColorTheme","colorTheme","hasBackgroundColor","backgroundColor","data","select","getSettings","length","console","warn","getValueByColorName","colorName","title","initialOpen","className"],"mappings":"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"}